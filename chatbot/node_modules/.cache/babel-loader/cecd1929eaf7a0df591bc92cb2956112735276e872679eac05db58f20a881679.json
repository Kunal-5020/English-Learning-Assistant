{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import{FaMicrophone}from\"react-icons/fa\";import axios from\"axios\";import\"./css/ChatInput.css\";import SpeechRecognition,{useSpeechRecognition}from\"react-speech-recognition\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const ChatInput=_ref=>{let{onSendMessage}=_ref;const[input,setInput]=useState(\"\");const{transcript,browserSupportsSpeechRecognition,resetTranscript}=useSpeechRecognition();const[history,setHistory]=useState([]);const[UserResponse,loadResponse]=useState(\"\");const[conversationStarted,setConversationStarted]=useState(false);// Start listening for speech\nconst startListening=()=>{resetTranscript();SpeechRecognition.startListening({continuous:true,language:\"en\"});};// Stop listening for speech\nconst stopListening=()=>{SpeechRecognition.stopListening();};useEffect(()=>{setInput(transcript);},[transcript]);// Handle starting the conversation\nconst handleStartConversation=async()=>{const startMessage=\"Start the conversation\";const userMessage={text:startMessage,sender:\"user\"};setHistory(prevHistory=>[...prevHistory,userMessage]);onSendMessage(userMessage);try{const response=await axios.post(\"http://localhost:5000/api/chat/generate\",{messagePayload:{history:[userMessage],current_message:{sender:\"user\",text:startMessage}}});const Response=response.data.response;const botResponse=Response.BotResponse;const userResponse=Response.UserResponse;setHistory(prevHistory=>[...prevHistory,{text:botResponse,sender:\"bot\"}]);onSendMessage({text:botResponse,sender:\"bot\"});loadResponse(userResponse);setConversationStarted(true);}catch(error){console.error(\"Error starting conversation:\",error);}};// Handle sending user input\nconst handleSend=async()=>{if(!input.trim())return;const userMessage={text:input,sender:\"user\"};setHistory(prevHistory=>[...prevHistory,userMessage]);onSendMessage(userMessage);setInput(\"\");try{const messagePayload={history:history.concat(userMessage),current_message:{sender:\"user\",text:input}};const response=await axios.post(\"http://localhost:5000/api/chat/generate\",{messagePayload});const Response=response.data.response;const botResponse=Response.BotResponse;const userResponse=Response.UserResponse;setHistory(prevHistory=>[...prevHistory,{text:botResponse,sender:\"bot\"}]);onSendMessage({text:botResponse,sender:\"bot\"});loadResponse(userResponse);}catch(error){console.error(\"Error sending message:\",error);}};const handleKeyDown=e=>{if(e.key===\"Enter\"){handleSend();}};if(!browserSupportsSpeechRecognition){return/*#__PURE__*/_jsx(\"p\",{children:\"Your browser does not support speech recognition.\"});}return/*#__PURE__*/_jsxs(\"div\",{className:\"chat-input\",children:[conversationStarted&&UserResponse&&/*#__PURE__*/_jsxs(\"div\",{className:\"user-response-display\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Expected Response:\"}),\" \",UserResponse]}),/*#__PURE__*/_jsx(\"div\",{className:\"input-container\",children:!conversationStarted?/*#__PURE__*/_jsx(\"button\",{className:\"start-button\",onClick:handleStartConversation,children:\"Start the Conversation\"}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:input,onChange:e=>setInput(e.target.value),onKeyDown:handleKeyDown,placeholder:\"Type your response here...\",className:\"input-field\"}),/*#__PURE__*/_jsx(\"button\",{className:\"mic-button\",onMouseDown:startListening,onMouseUp:stopListening,children:/*#__PURE__*/_jsx(FaMicrophone,{})}),/*#__PURE__*/_jsx(\"button\",{className:\"send-button\",onClick:handleSend,children:/*#__PURE__*/_jsx(\"svg\",{viewBox:\"0 0 24 24\",fill:\"none\",xmlns:\"http://www.w3.org/2000/svg\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M12 7V17M12 7L16 11M12 7L8 11M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z\",stroke:\"#2f2f2f\",strokeWidth:\"1.5\",strokeLinecap:\"round\",strokeLinejoin:\"round\"})})})]})})]});};export default ChatInput;","map":{"version":3,"names":["React","useState","useEffect","FaMicrophone","axios","SpeechRecognition","useSpeechRecognition","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","ChatInput","_ref","onSendMessage","input","setInput","transcript","browserSupportsSpeechRecognition","resetTranscript","history","setHistory","UserResponse","loadResponse","conversationStarted","setConversationStarted","startListening","continuous","language","stopListening","handleStartConversation","startMessage","userMessage","text","sender","prevHistory","response","post","messagePayload","current_message","Response","data","botResponse","BotResponse","userResponse","error","console","handleSend","trim","concat","handleKeyDown","e","key","children","className","onClick","type","value","onChange","target","onKeyDown","placeholder","onMouseDown","onMouseUp","viewBox","fill","xmlns","d","stroke","strokeWidth","strokeLinecap","strokeLinejoin"],"sources":["C:/Users/kunal/OneDrive/Documents/Github/English-Learning-Assistant/chatbot/src/component/ChatInput.jsx"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { FaMicrophone } from \"react-icons/fa\";\r\nimport axios from \"axios\";\r\nimport \"./css/ChatInput.css\";\r\nimport SpeechRecognition, { useSpeechRecognition } from \"react-speech-recognition\";\r\n\r\nconst ChatInput = ({ onSendMessage }) => {\r\n  const [input, setInput] = useState(\"\");\r\n  const { transcript, browserSupportsSpeechRecognition, resetTranscript } = useSpeechRecognition();\r\n  const [history, setHistory] = useState([]);\r\n  const [UserResponse, loadResponse] = useState(\"\");\r\n  const [conversationStarted, setConversationStarted] = useState(false);\r\n\r\n  // Start listening for speech\r\n  const startListening = () => {\r\n    resetTranscript();\r\n    SpeechRecognition.startListening({ continuous: true, language: \"en\" });\r\n  };\r\n\r\n  // Stop listening for speech\r\n  const stopListening = () => {\r\n    SpeechRecognition.stopListening();\r\n  };\r\n\r\n  useEffect(() => {\r\n    setInput(transcript);\r\n  }, [transcript]);\r\n\r\n  // Handle starting the conversation\r\n  const handleStartConversation = async () => {\r\n    const startMessage = \"Start the conversation\";\r\n    const userMessage = { text: startMessage, sender: \"user\" };\r\n    setHistory((prevHistory) => [...prevHistory, userMessage]);\r\n    onSendMessage(userMessage);\r\n\r\n    try {\r\n      const response = await axios.post(\"http://localhost:5000/api/chat/generate\", {\r\n        messagePayload: {\r\n          history: [userMessage],\r\n          current_message: { sender: \"user\", text: startMessage },\r\n        },\r\n      });\r\n\r\n      const Response = response.data.response;\r\n      const botResponse = Response.BotResponse;\r\n      const userResponse = Response.UserResponse;\r\n\r\n      setHistory((prevHistory) => [...prevHistory, { text: botResponse, sender: \"bot\" }]);\r\n      onSendMessage({ text: botResponse, sender: \"bot\" });\r\n      loadResponse(userResponse);\r\n      setConversationStarted(true);\r\n    } catch (error) {\r\n      console.error(\"Error starting conversation:\", error);\r\n    }\r\n  };\r\n\r\n  // Handle sending user input\r\n  const handleSend = async () => {\r\n    if (!input.trim()) return;\r\n\r\n    const userMessage = { text: input, sender: \"user\" };\r\n    setHistory((prevHistory) => [...prevHistory, userMessage]);\r\n    onSendMessage(userMessage);\r\n    setInput(\"\");\r\n\r\n    try {\r\n      const messagePayload = {\r\n        history: history.concat(userMessage),\r\n        current_message: { sender: \"user\", text: input },\r\n      };\r\n\r\n      const response = await axios.post(\"http://localhost:5000/api/chat/generate\", {\r\n        messagePayload,\r\n      });\r\n\r\n      const Response = response.data.response;\r\n      const botResponse = Response.BotResponse;\r\n      const userResponse = Response.UserResponse;\r\n\r\n      setHistory((prevHistory) => [...prevHistory, { text: botResponse, sender: \"bot\" }]);\r\n      onSendMessage({ text: botResponse, sender: \"bot\" });\r\n      loadResponse(userResponse);\r\n    } catch (error) {\r\n      console.error(\"Error sending message:\", error);\r\n    }\r\n  };\r\n\r\n  const handleKeyDown = (e) => {\r\n    if (e.key === \"Enter\") {\r\n      handleSend();\r\n    }\r\n  };\r\n\r\n  if (!browserSupportsSpeechRecognition) {\r\n    return <p>Your browser does not support speech recognition.</p>;\r\n  }\r\n\r\n  return (\r\n    <div className=\"chat-input\">\r\n      {conversationStarted && UserResponse && (\r\n        <div className=\"user-response-display\">\r\n          <strong>Expected Response:</strong> {UserResponse}\r\n        </div>\r\n      )}\r\n\r\n      <div className=\"input-container\">\r\n        {!conversationStarted ? (\r\n          <button className=\"start-button\" onClick={handleStartConversation}>\r\n            Start the Conversation\r\n          </button>\r\n        ) : (\r\n          <>\r\n            <input\r\n              type=\"text\"\r\n              value={input}\r\n              onChange={(e) => setInput(e.target.value)}\r\n              onKeyDown={handleKeyDown}\r\n              placeholder=\"Type your response here...\"\r\n              className=\"input-field\"\r\n            />\r\n            <button\r\n              className=\"mic-button\"\r\n              onMouseDown={startListening}\r\n              onMouseUp={stopListening}\r\n            >\r\n              <FaMicrophone />\r\n            </button>\r\n            <button className=\"send-button\" onClick={handleSend}>\r\n              <svg viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\r\n                <path\r\n                  d=\"M12 7V17M12 7L16 11M12 7L8 11M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z\"\r\n                  stroke=\"#2f2f2f\"\r\n                  strokeWidth=\"1.5\"\r\n                  strokeLinecap=\"round\"\r\n                  strokeLinejoin=\"round\"\r\n                />\r\n              </svg>\r\n            </button>\r\n          </>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ChatInput;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}